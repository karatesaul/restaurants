"use strict";(self.webpackChunkrestaurants=self.webpackChunkrestaurants||[]).push([[785],{6785:(O,v,i)=>{i.r(v),i.d(v,{default:()=>$});var u=i(177),g=i(5351),T=i(8359),c=i(5558),C=i(1719),t=i(1808),r=i(9417),p=i(4518),E=i(8834),m=i(6471),h=i(882),F=i(1801),D=i(5416),b=i(8141),j=i(6600);const y=["tagsInput"];function S(n,l){if(1&n){const o=t.RV6();t.j41(0,"mat-chip-row",12),t.bIt("removed",function(){const a=t.eBV(o).$implicit,e=t.XpG();return t.Njj(e.remove(a))}),t.EFF(1),t.j41(2,"button",13)(3,"mat-icon"),t.EFF(4,"cancel"),t.k0s()()()}if(2&n){const o=l.$implicit;t.R7$(),t.SpI(" ",o.value," ")}}function G(n,l){if(1&n&&(t.j41(0,"mat-option",14),t.EFF(1),t.k0s()),2&n){const o=l.$implicit;t.Y8G("value",o.id),t.R7$(),t.SpI(" ",o.value," ")}}let V=(()=>{var n;class l{constructor(s,a,e){this.data=s,this.matSnackbar=a,this.tagsService=e,this.sub=new T.yU,this.existingTags=(0,t.vPA)([]),this.filteredTags=(0,t.EWP)(()=>this.filterTags()),this.filterValue=(0,t.vPA)(""),this.tags=this.data.tags,this.tagsCtrl=new r.MJ,this.form=new r.gE([this.tagsCtrl])}ngOnInit(){this.sub.add(this.tagsService.list().subscribe(s=>this.existingTags.set(s))),this.sub.add(this.tagsCtrl.valueChanges.subscribe(s=>this.filterValue.set(s)))}ngOnDestroy(){this.sub.unsubscribe()}add(s){const a=(s.value||"").trim();a&&this.sub.add(this.tagsService.create({value:a}).pipe((0,b.M)(()=>{this.matSnackbar.open(`Created new tag with name "${a}"`,void 0,{duration:3e3})}),(0,c.n)(e=>this.tagsService.read(e))).subscribe(e=>{if(!e)throw new Error("Error reading new tag");this.tags.push(e)})),s.chipInput.clear(),this.tagsCtrl.setValue(null)}filterTags(){return this.existingTags().filter(s=>s.value.includes(this.filterValue()))}remove(s){const a=this.tags.indexOf(s);a>=0&&this.tags.splice(a,1)}selected(s){const a=this.existingTags().find(e=>e.id===s.option.value);if(!a)throw new Error("Tag not found");this.tags.push(a),this.tagsInput.nativeElement.value="",this.tagsCtrl.setValue(null)}}return(n=l).\u0275fac=function(s){return new(s||n)(t.rXU(g.Vh),t.rXU(D.UG),t.rXU(C.A))},n.\u0275cmp=t.VBU({type:n,selectors:[["edit-tags-dialog"]],viewQuery:function(s,a){if(1&s&&t.GBs(y,5),2&s){let e;t.mGM(e=t.lsd())&&(a.tagsInput=e.first)}},standalone:!0,features:[t.aNF],decls:18,vars:7,consts:[["chipGrid",""],["tagsInput",""],["auto","matAutocomplete"],[3,"formGroup"],["mat-dialog-title",""],[1,"form-layout-field"],[3,"removed",4,"ngFor","ngForOf"],["placeholder","Tags...",3,"matChipInputTokenEnd","formControl","matChipInputFor","matAutocomplete"],["autoActiveFirstOption","",3,"optionSelected"],[3,"value",4,"ngFor","ngForOf"],["align","end"],["mat-flat-button","","color","primary","type","submit",3,"mat-dialog-close"],[3,"removed"],["matChipRemove",""],[3,"value"]],template:function(s,a){if(1&s){const e=t.RV6();t.j41(0,"form",3)(1,"h1",4),t.EFF(2,"Edit Tags"),t.k0s(),t.j41(3,"mat-dialog-content")(4,"mat-form-field",5)(5,"mat-label"),t.EFF(6,"Tags"),t.k0s(),t.j41(7,"mat-chip-grid",null,0),t.DNE(9,S,5,1,"mat-chip-row",6),t.k0s(),t.j41(10,"input",7,1),t.bIt("matChipInputTokenEnd",function(f){return t.eBV(e),t.Njj(a.add(f))}),t.k0s(),t.j41(12,"mat-autocomplete",8,2),t.bIt("optionSelected",function(f){return t.eBV(e),t.Njj(a.selected(f))}),t.DNE(14,G,2,2,"mat-option",9),t.k0s()()(),t.j41(15,"mat-dialog-actions",10)(16,"button",11),t.EFF(17," Save "),t.k0s()()()}if(2&s){const e=t.sdS(8),d=t.sdS(13);t.Y8G("formGroup",a.form),t.R7$(9),t.Y8G("ngForOf",a.tags),t.R7$(),t.Y8G("formControl",a.tagsCtrl)("matChipInputFor",e)("matAutocomplete",d),t.R7$(4),t.Y8G("ngForOf",a.filteredTags()),t.R7$(2),t.Y8G("mat-dialog-close",a.tags)}},dependencies:[u.MD,u.Sq,p.jL,p.$3,j.wT,p.pN,E.Hl,E.$z,m.YN,m.HW,m.D7,m.Zv,m.jH,g.hM,g.tx,g.BI,g.E7,g.Yi,h.RG,h.rl,h.nJ,F.m_,F.An,D._T,r.X1,r.qT,r.me,r.BC,r.cb,r.l_,r.j4],styles:[".form-layout-field[_ngcontent-%COMP%]{display:flex}"]}),l})();var U=i(2003),I=i(7062);let $=(()=>{var n;class l{constructor(s,a,e,d){this.matDialog=s,this.route=a,this.router=e,this.tagsService=d,this.sub=new T.yU}ngOnInit(){this.sub.add(this.route.data.pipe((0,c.n)(s=>this.tagsService.searchIds(s.restaurant?.tags)),(0,c.n)(s=>this.matDialog.open(V,{data:{tags:s}}).afterClosed())).subscribe(s=>{this.router.navigate([".."],{relativeTo:this.route,state:{type:U.r.EditTags,tags:s}})}))}ngOnDestroy(){this.sub.unsubscribe()}}return(n=l).\u0275fac=function(s){return new(s||n)(t.rXU(g.bZ),t.rXU(I.nX),t.rXU(I.Ix),t.rXU(C.A))},n.\u0275cmp=t.VBU({type:n,selectors:[["edit-tags"]],standalone:!0,features:[t.aNF],decls:0,vars:0,template:function(s,a){},dependencies:[u.MD,g.hM],encapsulation:2}),l})()}}]);