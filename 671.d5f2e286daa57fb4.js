"use strict";(self.webpackChunkrestaurants=self.webpackChunkrestaurants||[]).push([[671],{7671:(O,d,s)=>{s.r(d),s.d(d,{default:()=>N});var c=s(6814),u=s(7700),f=s(7394),v=s(4664),I=s(6232),t=s(5879),i=s(6223),g=s(6381),C=s(2296),m=s(2557),p=s(9157),T=s(1175),Z=s(2032),A=s(2939),R=s(9397),F=s(2072),b=s(3680);const D=["tagsInput"];function S(o,h){if(1&o){const e=t.EpF();t.TgZ(0,"mat-chip-row",13),t.NdJ("removed",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.remove(r))}),t._uU(1),t.TgZ(2,"button",14)(3,"mat-icon"),t._uU(4,"cancel"),t.qZA()()()}if(2&o){const e=h.$implicit;t.xp6(1),t.hij(" ",e.value," ")}}function x(o,h){if(1&o&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&o){const e=h.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.value," ")}}let J=(()=>{class o{constructor(e,a){this.matSnackBar=e,this.tagsService=a,this.sub=new f.w0,this.existingTags=(0,t.tdS)([]),this.filteredTags=(0,t.Flj)(()=>this.filterTags()),this.filterValue=(0,t.tdS)(""),this.name=new i.NI,this.tags=[],this.tagsCtrl=new i.NI,this.form=new i.cw({name:this.name,tags:this.tagsCtrl})}ngOnInit(){this.sub.add(this.tagsService.list().subscribe(e=>this.existingTags.set(e))),this.sub.add(this.tagsCtrl.valueChanges.subscribe(e=>this.filterValue.set(e)))}ngOnDestroy(){this.sub.unsubscribe()}add(e){const a=(e.value||"").trim();a&&this.sub.add(this.tagsService.create({value:a}).pipe((0,R.b)(()=>{this.matSnackBar.open(`Created new tag with name "${a}"`,void 0,{duration:3e3})}),(0,v.w)(n=>this.tagsService.read(n))).subscribe(n=>{if(!n)throw new Error("Error reading new tag");this.tags.push(n)})),e.chipInput.clear(),this.tagsCtrl.setValue(null)}filterTags(){return this.existingTags().filter(e=>e.value.includes(this.filterValue()))}getRestaurantPayload(){return{...this.form.value,tags:this.tags.map(e=>e.id)}}remove(e){const a=this.tags.indexOf(e);a>=0&&this.tags.splice(a,1)}selected(e){const a=this.existingTags().find(n=>n.id===e.option.value);if(!a)throw new Error("Tag not found");this.tags.push(a),this.tagsInput.nativeElement.value="",this.tagsCtrl.setValue(null)}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(A.ux),t.Y36(F.Z))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["create-restaurant-dialog"]],viewQuery:function(a,n){if(1&a&&t.Gf(D,5),2&a){let r;t.iGM(r=t.CRH())&&(n.tagsInput=r.first)}},standalone:!0,features:[t.jDz],decls:22,vars:8,consts:[[3,"formGroup"],["mat-dialog-title",""],[1,"form-layout-field"],["matInput","",3,"formControl"],["chipGrid",""],[3,"removed",4,"ngFor","ngForOf"],["placeholder","New Tags...",3,"formControl","matChipInputFor","matAutocomplete","matChipInputTokenEnd"],["tagsInput",""],["autoActiveFirstOption","",3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["align","end"],["mat-flat-button","","color","primary","type","submit",3,"mat-dialog-close"],[3,"removed"],["matChipRemove",""],[3,"value"]],template:function(a,n){if(1&a&&(t.TgZ(0,"form",0)(1,"h1",1),t._uU(2,"Add Restaurant"),t.qZA(),t.TgZ(3,"mat-dialog-content")(4,"mat-form-field",2)(5,"mat-label"),t._uU(6,"Name"),t.qZA(),t._UZ(7,"input",3),t.qZA(),t.TgZ(8,"mat-form-field",2)(9,"mat-label"),t._uU(10,"Tags"),t.qZA(),t.TgZ(11,"mat-chip-grid",null,4),t.YNc(13,S,5,1,"mat-chip-row",5),t.qZA(),t.TgZ(14,"input",6,7),t.NdJ("matChipInputTokenEnd",function(l){return n.add(l)}),t.qZA(),t.TgZ(16,"mat-autocomplete",8,9),t.NdJ("optionSelected",function(l){return n.selected(l)}),t.YNc(18,x,2,2,"mat-option",10),t.qZA()()(),t.TgZ(19,"mat-dialog-actions",11)(20,"button",12),t._uU(21," Add "),t.qZA()()()),2&a){const r=t.MAs(12),l=t.MAs(17);t.Q6J("formGroup",n.form),t.xp6(7),t.Q6J("formControl",n.name),t.xp6(6),t.Q6J("ngForOf",n.tags),t.xp6(1),t.Q6J("formControl",n.tagsCtrl)("matChipInputFor",r)("matAutocomplete",l),t.xp6(4),t.Q6J("ngForOf",n.filteredTags()),t.xp6(2),t.Q6J("mat-dialog-close",n.getRestaurantPayload())}},dependencies:[c.ez,c.sg,g.Bb,g.XC,b.ey,g.ZL,C.ot,C.lW,m.Hi,m.RA,m.oH,m.qH,m.z3,u.Is,u.ZT,u.uh,u.xY,u.H8,p.lN,p.KE,p.hX,T.Ps,T.Hw,Z.c,Z.Nt,A.ZX,i.UX,i._Y,i.Fj,i.JJ,i.JL,i.oH,i.sg],styles:[".form-layout-field[_ngcontent-%COMP%]{display:flex}"]})}return o})();var w=s(3546),y=s(3403);let N=(()=>{class o{constructor(e,a,n,r,l){this.matDialog=e,this.restaurantService=a,this.route=n,this.router=r,this.zone=l,this.sub=new f.w0}ngOnInit(){this.sub.add(this.matDialog.open(J,{minWidth:500}).afterClosed().pipe((0,v.w)(e=>e?this.restaurantService.create(e):I.E)).subscribe({complete:()=>this.zone.run(()=>this.router.navigate([".."],{relativeTo:this.route}))}))}ngOnDestroy(){this.sub.unsubscribe()}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(u.uw),t.Y36(w.Z),t.Y36(y.gz),t.Y36(y.F0),t.Y36(t.R0b))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["create-restaurant"]],standalone:!0,features:[t.jDz],decls:0,vars:0,template:function(a,n){},dependencies:[c.ez,u.Is],encapsulation:2})}return o})()}}]);