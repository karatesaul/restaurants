"use strict";(self.webpackChunkrestaurants=self.webpackChunkrestaurants||[]).push([[396],{9396:(I,h,e)=>{e.r(h),e.d(h,{default:()=>R});var d=e(177),t=e(1808),g=e(8834),r=e(5596),E=e(6471),v=e(1801),i=e(7062),D=e(8359),m=e(8141),c=e(5558),O=e(7673),P=e(6777),p=e(1719),M=e(2003);function C(n,_){if(1&n&&(t.j41(0,"mat-chip"),t.EFF(1),t.k0s()),2&n){const u=_.$implicit;t.R7$(),t.SpI(" ",u.value," ")}}let R=(()=>{var n;class _{constructor(s,a,o,f,T){this.location=s,this.restaurantService=a,this.route=o,this.router=f,this.tagsService=T,this.sub=new D.yU,this.restaurant=(0,t.vPA)(null),this.tags=(0,t.vPA)([]),this.sub.add(this.route.data.pipe((0,m.M)(l=>this.restaurant.set(l.restaurant)),(0,c.n)(l=>this.tagsService.searchIds(l.restaurant.tags))).subscribe(l=>{this.tags.set(l)}))}ngOnDestroy(){this.sub.unsubscribe()}onDeactivate(){const s=this.location.getState();switch(s.type){case M.r.Delete:this.onDelete(s);break;case M.r.EditTags:this.onEditTags(s)}}onDelete(s){if(!s.delete)return;const a=this.restaurant()?.id;a&&(this.sub.add(this.restaurantService.delete(a).subscribe()),this.router.navigate([".."],{relativeTo:this.route}))}onEditTags(s){this.sub.add(this.restaurantService.update(this.restaurant()?.id,{tags:s.tags?.map(a=>a.id).filter(a=>!!a)}).pipe((0,c.n)(a=>{if(!a)throw this.router.navigate(["search"]),new Error("Restaurant not found.");return(0,O.of)(a)}),(0,m.M)(a=>this.restaurant.set(a)),(0,c.n)(a=>this.tagsService.searchIds(a.tags))).subscribe(a=>this.tags.set(a)))}}return(n=_).\u0275fac=function(s){return new(s||n)(t.rXU(d.aZ),t.rXU(P.A),t.rXU(i.nX),t.rXU(i.Ix),t.rXU(p.A))},n.\u0275cmp=t.VBU({type:n,selectors:[["restaurant"]],standalone:!0,features:[t.aNF],decls:17,vars:2,consts:[[1,"detail-page"],[1,"detail-page-header"],["color","warn","mat-flat-button","","routerLink","delete",1,"detail-page-delete"],[1,"detail-page-tiles"],[1,"detail-page-tile"],["mat-button","","routerLink","edit-tags",1,"detail-page-tile-edit"],[4,"ngFor","ngForOf"],[3,"deactivate"]],template:function(s,a){if(1&s&&(t.j41(0,"div",0)(1,"header",1)(2,"h1"),t.EFF(3),t.k0s(),t.j41(4,"button",2),t.EFF(5," Delete "),t.k0s()(),t.j41(6,"div",3)(7,"mat-card",4)(8,"mat-card-header")(9,"mat-card-title"),t.EFF(10,"Tags"),t.k0s(),t.j41(11,"a",5),t.EFF(12," Edit "),t.k0s()(),t.j41(13,"mat-card-content")(14,"mat-chip-set"),t.DNE(15,C,2,1,"mat-chip",6),t.k0s()()()()(),t.j41(16,"router-outlet",7),t.bIt("deactivate",function(){return a.onDeactivate()}),t.k0s()),2&s){let o;t.R7$(3),t.JRh(null==(o=a.restaurant())?null:o.name),t.R7$(12),t.Y8G("ngForOf",a.tags())}},dependencies:[d.MD,d.Sq,g.Hl,g.It,g.$z,r.Hu,r.RN,r.m2,r.MM,r.dh,E.YN,E.Jl,E.Jo,v.m_,i.iI,i.n3,i.Wk],styles:[".detail-page[_ngcontent-%COMP%]{padding:2rem;box-sizing:border-box}.detail-page-header[_ngcontent-%COMP%]{display:flex}.detail-page-delete[_ngcontent-%COMP%]{margin-left:auto}.detail-page-tiles[_ngcontent-%COMP%]{display:flex;gap:2rem}.detail-page-tile[_ngcontent-%COMP%]{width:33%}.detail-page-tile-edit[_ngcontent-%COMP%]{margin-left:auto}"]}),_})()}}]);